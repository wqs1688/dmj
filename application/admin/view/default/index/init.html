{{include file="public/header" /}}

<!-- right content start  -->
<div class="content-right">
	<div class="content">
		{{if $is_system_show_base eq 1}}
			<!-- 顶部提示信息 -->
			{{if !empty($site_store_info) and !empty($site_store_info['base']) and !empty($site_store_info['base']['site_top_notice'])}}
				<div class="am-alert am-alert-danger" data-am-alert>
					<button type="button" class="am-close">&times;</button>
					<p>{{$site_store_info.base.site_top_notice|raw}}</p>
				</div>
			{{/if}}

			<!-- 顶部基础信息 -->
			
		{{/if}}

		<!-- 基础统计 -->
		<div class="block-container shopxo-base">
			<div class="echarts-title">
				<span class="icon"></span>
				<span class="title">{{:lang("common_admin_init_stat")}}</span>
			</div>
			<ul class="am-avg-sm-2 am-avg-lg-4">
				<li>
					<div class="li-content">
						<p class="name">{{:lang("common_admin_init_stat_user")}}</p>
						<p class="total animation-count-to" data-to="{{$user.total_count}}" data-speed="1500">0</p>
						<div class="item am-margin-bottom-xs">
							<span>{{:lang("common_admin_init_date1")}}</span>
							<span class="animation-count-to" data-to="{{$user.last_month_count}}" data-speed="1500">0</span>
						</div>
						<div class="item am-margin-bottom-xs">
							<span>{{:lang("common_admin_init_date2")}}</span>
							<span class="animation-count-to" data-to="{{$user.same_month_count}}" data-speed="1500">0</span>
						</div>
						<div class="item am-margin-bottom-xs">
							<span>{{:lang("common_admin_init_date3")}}</span>
							<span class="animation-count-to" data-to="{{$user.yesterday_count}}" data-speed="1500">0</span>
						</div>
						<div class="item">
							<span>{{:lang("common_admin_init_date4")}}</span>
							<span class="animation-count-to" data-to="{{$user.today_count}}" data-speed="1500">0</span>
						</div>
						<i class="am-icon-user am-icon-lg bg-icon"></i>
					</div>
				</li>
				<li>
					<div class="li-content">
						<p class="name">{{:lang("common_admin_init_stat_order")}}</p>
						<p class="total animation-count-to" data-to="{{$order_number.total_count}}" data-speed="1500">0</p>
						<div class="item am-margin-bottom-xs">
							<span>{{:lang("common_admin_init_date1")}}</span>
							<span class="animation-count-to" data-to="{{$order_number.last_month_count}}" data-speed="1500">0</span>
						</div>
						<div class="item am-margin-bottom-xs">
							<span>{{:lang("common_admin_init_date2")}}</span>
							<span class="animation-count-to" data-to="{{$order_number.same_month_count}}" data-speed="1500">0</span>
						</div>
						<div class="item am-margin-bottom-xs">
							<span>{{:lang("common_admin_init_date3")}}</span>
							<span class="animation-count-to" data-to="{{$order_number.yesterday_count}}" data-speed="1500">0</span>
						</div>
						<div class="item">
							<span>{{:lang("common_admin_init_date4")}}</span>
							<span class="animation-count-to" data-to="{{$order_number.today_count}}" data-speed="1500">0</span>
						</div>
						<i class="am-icon-pie-chart am-icon-lg bg-icon"></i>
					</div>
				</li>
				<li>
					<div class="li-content">
						<p class="name">{{:lang("common_admin_init_stat_deal")}}</p>
						<p class="total animation-count-to" data-to="{{$order_complete_number.total_count}}" data-speed="1500">0</p>
						<div class="item am-margin-bottom-xs">
							<span>{{:lang("common_admin_init_date1")}}</span>
							<span class="animation-count-to" data-to="{{$order_complete_number.last_month_count}}" data-speed="1500">0</span>
						</div>
						<div class="item am-margin-bottom-xs">
							<span>{{:lang("common_admin_init_date2")}}</span>
							<span class="animation-count-to" data-to="{{$order_complete_number.same_month_count}}" data-speed="1500">0</span>
						</div>
						<div class="item am-margin-bottom-xs">
							<span>{{:lang("common_admin_init_date3")}}</span>
							<span class="animation-count-to" data-to="{{$order_complete_number.yesterday_count}}" data-speed="1500">0</span>
						</div>
						<div class="item">
							<span>{{:lang("common_admin_init_date4")}}</span>
							<span class="animation-count-to" data-to="{{$order_complete_number.today_count}}" data-speed="1500">0</span>
						</div>
						<i class="am-icon-gg am-icon-lg bg-icon"></i>
					</div>
				</li>
				<li>
					<div class="li-content">
						<p class="name">{{:lang("common_admin_init_stat_inco")}}</p>
						<p class="total animation-count-to" data-to="{{$order_complete_money.total_count}}" data-speed="1500" data-decimals="2">0.00</p>
						<div class="item am-margin-bottom-xs">
							<span>{{:lang("common_admin_init_date1")}}</span>
							<span class="animation-count-to" data-to="{{$order_complete_money.last_month_count}}" data-speed="1500">0</span>
						</div>
						<div class="item am-margin-bottom-xs">
							<span>{{:lang("common_admin_init_date2")}}</span>
							<span class="animation-count-to" data-to="{{$order_complete_money.same_month_count}}" data-speed="1500">0</span>
						</div>
						<div class="item am-margin-bottom-xs">
							<span>{{:lang("common_admin_init_date3")}}</span>
							<span class="animation-count-to" data-to="{{$order_complete_money.yesterday_count}}" data-speed="1500" data-decimals="2">0.00</span>
						</div>
						<div class="item">
							<span>{{:lang("common_admin_init_date4")}}</span>
							<span class="animation-count-to" data-to="{{$order_complete_money.today_count}}" data-speed="1500" data-decimals="2">0.00</span>
						</div>
						<i class="am-icon-line-chart am-icon-lg bg-icon"></i>
					</div>
				</li>
			</ul>
		</div>

		<!-- 近30日订单成交金额走势 -->
		<div class="block-container">
			<div class="echarts-title">
				<span class="icon"></span>
				<span class="title">{{:lang("common_admin_init_deal_trend")}}</span>
			</div>
			<div id="echarts-order-profit"></div>
		</div>

		<!-- 近30日订单交易走势 -->
		<div class="block-container">
			<div class="echarts-title">
				<span class="icon"></span>
				<span class="title">{{:lang("common_admin_init_order_trend")}}</span>
			</div>
			<div id="echarts-order-trading"></div>
		</div>

		<!-- 组合 -->
		<ul class="am-avg-sm-1 am-avg-sm-2 am-avg-lg-2 block-combination-container-2 {{if $is_system_show_base eq 0}}am-padding-bottom-sm{{/if}}">
			<li>
				<!-- 近30日热销商品 -->
				<div class="echarts-title">
					<span class="icon"></span>
					<span class="title">{{:lang("common_admin_init_hot_product")}}</span>
				</div>
				<div id="echarts-goods-hot"></div>
			</li>

			<li>
				<!-- 近30日支付方式 -->
				<div class="echarts-title">
					<span class="icon"></span>
					<span class="title">{{:lang("common_admin_init_pay")}}</span>
				</div>
				<div id="echarts-pay-type"></div>
			</li>
		</ul>

		<!-- 系统信息 -->
		{{if $is_system_show_base eq 1}}
			<ul class="am-avg-sm-1 am-avg-sm-2 am-avg-lg-2 block-combination-container-2 am-padding-bottom-sm">
				<li>
					<div class="echarts-title">
						<span class="icon"></span>
						<span class="title">系统信息</span>
					</div>
					<dl class="dl-content">
						<dt>软件版本</dt>
						<dd>{{$data.ver}}</dd>

						<dt>操作系统</dt>
						<dd>{{$data.os_ver}}</dd>

						<dt>PHP版本</dt>
						<dd>{{$data.php_ver}}</dd>

						<dt>MySQL版本</dt>
						<dd>{{$data.mysql_ver}}</dd>

						<dt>服务器端信息</dt>
						<dd>{{$data.server_ver}}</dd>

						<dt>当前域名</dt>
						<dd>{{$data.host}}</dd>
					</dl>
				</li>

				<li>
					<div class="echarts-title">
						<span class="icon"></span>
						<span class="title">开发团队</span>
					</div>
					<dl class="dl-content">
						<dt>公司官网</dt>
						<dd>
							<a href="http://zongzhige.com/" target="_blank">上海纵之格科技有限公司</a>
						</dd>

						<dt>技术支持</dt>
						<dd>
							<a href="http://shopxo.net/" target="_blank">ShopXO企业级电商系统提供商</a>
						</dd>

						<dt>交流社区</dt>
						<dd>
							<a href="http://ask.shopxo.net/" target="_blank">ShopXO交流社区</a>
						</dd>

						<dt>开源协议</dt>
						<dd>
							<a href="http://ask.shopxo.net/article/15" target="_blank">查看开源协议</a>
						</dd>

						<dt>研发成员</dt>
						<dd>
							<a href="http://gong.gg/" target="_blank">龚哥哥</a>
						</dd>

						<dt>更新日志</dt>
						<dd>
							<a href="http://ask.shopxo.net/article/148" target="_blank">查看更新日志</a>
						</dd>
					</dl>
				</li>
			</ul>
		{{/if}}
	</div>
</div>
<!-- right content end  -->

<!-- 检查更新显示信息 -->
<div class="am-popup popup-not-title" id="inspect-upgrade-popup">
    <div class="am-popup-inner">
        <span data-am-modal-close class="am-close am-close-alt am-icon-times"></span>
        <div class="am-popup-bd">
        	<div class="upgrade-content"></div>
			<div class="upgrade-bottom am-text-right">
				<div class="upgrade-bottom-content">
					<button type="button" class="am-btn am-btn-default am-radius am-btn-xs" data-am-modal-close>取消</button>
					<button type="button" class="am-btn am-btn-success am-radius am-btn-xs am-margin-left-sm am-hide inspect-upgrade-confirm" data-url="{{:MyUrl('admin/index/inspectupgradeconfirm')}}">立即更新</button>
				</div>
			</div>
        </div>
    </div>
</div>

<!-- footer start -->
{{include file="public/footer" /}}
<!-- footer end -->

<script type="text/javascript">
$(function()
{
	// 近30日订单成交金额走势
    var order_profit_chart = echarts.init(document.getElementById('echarts-order-profit'), 'macarons');
    var option = {
	    tooltip : {
	        trigger: 'axis',
	        axisPointer: {
	            type: 'cross',
	            label: {
	                backgroundColor: '#6a7985'
	            }
	        }
	    },
	    legend: {
	        data: {{:json_encode($order_profit_chart.title_arr)}}
	    },
	    toolbox: {
	        show : {{if IsMobile()}}false{{else}}true{{/if}},
	        feature : {
	            mark : {show: true},
	            dataView : {show: true, readOnly: false},
	            magicType : {show: true, type: ['line', 'bar', 'stack', 'tiled']},
	            restore : {show: true},
	            saveAsImage : {name:'近30日订单交易走势', show: true}
	        }
	    },
	    grid: {
	        left: '3%',
	        right: '4%',
	        bottom: '3%',
	        containLabel: true
	    },
	    xAxis : [
	        {
	            type : 'category',
	            boundaryGap : false,
	            data : {{:json_encode($order_profit_chart.name_arr)}}
	        }
	    ],
	    yAxis : [
	        {
	            type : 'value'
	        }
	    ],
	    series : {{:json_encode($order_profit_chart.data)}}
	};
	order_profit_chart.setOption(option);

	// 近30日订单交易走势
    var order_trading_chart = echarts.init(document.getElementById('echarts-order-trading'), 'macarons');
    var option = {
	    tooltip : {
	        trigger: 'axis',
	        axisPointer: {
	            type: 'cross',
	            label: {
	                backgroundColor: '#6a7985'
	            }
	        }
	    },
	    legend: {
	        data: {{:json_encode($order_trading_trend.title_arr)}}
	    },
	    toolbox: {
	        show : {{if IsMobile()}}false{{else}}true{{/if}},
	        feature : {
	            mark : {show: true},
	            dataView : {show: true, readOnly: false},
	            magicType : {show: true, type: ['line', 'bar', 'stack', 'tiled']},
	            restore : {show: true},
	            saveAsImage : {name:'近30日订单交易走势', show: true}
	        }
	    },
	    grid: {
	        left: '3%',
	        right: '4%',
	        bottom: '3%',
	        containLabel: true
	    },
	    xAxis : [
	        {
	            type : 'category',
	            boundaryGap : false,
	            data : {{:json_encode($order_trading_trend.name_arr)}}
	        }
	    ],
	    yAxis : [
	        {
	            type : 'value'
	        }
	    ],
	    series : {{:json_encode($order_trading_trend.data)}}
	};
	order_trading_chart.setOption(option);


    // 近30日热销商品
    var goods_hot_chart = echarts.init(document.getElementById('echarts-goods-hot'), 'macarons');
    var option = {
    	title : {
	        subtext: '仅显示前10条商品',
	        x:'center'
	    },
	    tooltip : {
	        trigger: 'item',
	        formatter: "{b} : {c} ({d}%)"
	    },
	    toolbox: {
	        show : {{if IsMobile()}}false{{else}}true{{/if}},
	        feature : {
	            mark : {show: true},
	            dataView : {show: true, readOnly: false},
	            magicType : {
	                show: true, 
	                type: ['pie', 'funnel'],
	                option: {
	                    funnel: {
	                        x: '25%',
	                        width: '50%',
	                        funnelAlign: 'left',
	                        max: 1548
	                    }
	                }
	            },
	            restore : {show: false},
	            saveAsImage : {name:'近30日热销商品', show: true}
	        }
	    },
	    calculable : true,
	    series : [
	        {
	            type:'pie',
	            radius : '55%',
	            center: ['50%', '60%'],
	            data: {{:json_encode($goods_hot_sale.data)}}
	        }
	    ]
	};
    goods_hot_chart.setOption(option);

    // 近30日支付方式
    var order_pay_type_chart = echarts.init(document.getElementById('echarts-pay-type'), 'macarons');
    var option = {
	    tooltip : {
	        trigger: 'axis'
	    },
	    legend: {
	        data: {{:json_encode($pay_type_number.title_arr)}}
	    },
	    toolbox: {
	        show : {{if IsMobile()}}false{{else}}true{{/if}},
	        feature : {
	            mark : {show: true},
	            dataView : {show: true, readOnly: false},
	            magicType : {show: true, type: ['line', 'bar']},
	            restore : {show: false},
	            saveAsImage : {name:'近30日支付方式', show: true}
	        }
	    },
	    calculable : true,
	    xAxis : [
	        {
	            type : 'category',
	            boundaryGap : false,
	            data : {{:json_encode($pay_type_number.name_arr)}}
	        }
	    ],
	    yAxis : [
	        {
	            type : 'value'
	        }
	    ],
	    series : {{:json_encode($pay_type_number.data)}}
	};
    order_pay_type_chart.setOption(option);

	// 浏览器大小改变则实时更新图表大小
	window.onresize = function ()
	{
	    order_pay_type_chart.resize();
	    goods_hot_chart.resize();
	    order_profit_chart.resize();
	    order_trading_chart.resize();
	};
});
</script>