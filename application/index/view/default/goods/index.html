{{include file="public/header" /}}

<!-- header top nav -->
{{include file="public/header_top_nav" /}}

<!-- search -->
{{include file="public/nav_search" /}}

<!-- header nav -->
{{include file="public/header_nav" /}}

<!-- goods category -->
{{include file="public/goods_category" /}}

<div class="goods-detail" data-id="{{$goods.id}}" data-spec-detail-ajax-url="{{:MyUrl('index/goods/specdetail')}}" data-spec-type-ajax-url="{{:MyUrl('index/goods/spectype')}}">
    <!-- 轮播 -->
    <div class="scoll">
        <div class="slider-content">
            <div data-am-widget="slider" class="am-slider am-slider-a1" data-am-slider='{"directionNav":false}' >
                <ul class="am-slides">
                    {{if !empty($goods.photo)}}
                        {{foreach $goods.photo as $photo}}
                            <li>
                                <img src="{{$photo.images}}" title="{{$goods.title}}" />
                            </li>
                        {{/foreach}}
                    {{/if}}
                </ul>
            </div>

            <!-- 视频 -->
            {{if !empty($goods.video)}}
                <i class="am-icon-play-circle-o goods-video-submit-start"></i>
                <i class="goods-video-submit-close none">&times;</i>
                <video class="goods-video-container none" src="{{$goods.video}}" controls="controls" preload="auto">
                    your browser does not support the video tag
                </video>
            {{/if}}

            <!-- 商品页面相册内部钩子 -->
            {{if isset($shopxo_is_develop) and $shopxo_is_develop eq true and (!isset($is_footer) or $is_footer eq 1)}}
                <div class="plugins-tag">
                    <span>plugins_view_goods_detail_photo_within</span>
                </div>
            {{/if}}
            {{if !empty($plugins_view_goods_detail_photo_within_data) and is_array($plugins_view_goods_detail_photo_within_data)}}
                {{foreach $plugins_view_goods_detail_photo_within_data as $hook}}
                    {{if is_string($hook) or is_int($hook)}}
                        {{$hook|raw}}
                    {{/if}}
                {{/foreach}}
            {{/if}}
        </div>

        <!-- 商品页面相册底部钩子 -->
        {{if isset($shopxo_is_develop) and $shopxo_is_develop eq true and (!isset($is_footer) or $is_footer eq 1)}}
            <div class="plugins-tag">
                <span>plugins_view_goods_detail_photo_bottom</span>
            </div>
        {{/if}}
        {{if !empty($plugins_view_goods_detail_photo_bottom_data) and is_array($plugins_view_goods_detail_photo_bottom_data)}}
            {{foreach $plugins_view_goods_detail_photo_bottom_data as $hook}}
                {{if is_string($hook) or is_int($hook)}}
                    {{$hook|raw}}
                {{/if}}
            {{/foreach}}
        {{/if}}
    </div>

    <!-- 基础信息 -->
    <div class="item-inform am-container">
        <!-- pc放大镜 / 左侧 -->
        <div class="clearfix-left" id="clearcontent">
            <div class="box">
                <div class="tb-booth tb-pic tb-s310">
                    {{if !empty($goods['photo'][0])}}
                        <img src="{{$goods['photo'][0]['images']}}" alt="{{$goods.title}}" rel="{{$goods['photo'][0]['images']}}" class="jqzoom" />
                    {{/if}}
                </div>
                <ul class="tb-thumb" id="thumblist">
                    {{if !empty($goods.photo)}}
                        {{foreach $goods.photo as $photo_key=>$photo}}
                            <li class="{{if $photo_key eq 0}}tb-selected{{else /}} tb-pic{{/if}}">
                                <div class="tb-pic tb-s40">
                                    <a href="javascript:;">
                                        <img src="{{$photo.images}}" mid="{{$photo.images}}" big="{{$photo.images}}" class="tb-s40" />
                                    </a>
                                </div>
                            </li>
                        {{/foreach}}
                    {{/if}}
                </ul>

                <!-- 视频 -->
                {{if !empty($goods.video)}}
                    <i class="am-icon-play-circle-o goods-video-submit-start"></i>
                    <i class="goods-video-submit-close none">&times;</i>
                    <video class="goods-video-container none" src="{{$goods.video}}" controls="controls" preload="auto">
                        your browser does not support the video tag
                    </video>
                {{/if}}

                <!-- 商品页面相册内部钩子 -->
                {{if isset($shopxo_is_develop) and $shopxo_is_develop eq true and (!isset($is_footer) or $is_footer eq 1)}}
                    <div class="plugins-tag">
                        <span>plugins_view_goods_detail_photo_within</span>
                    </div>
                {{/if}}
                {{if !empty($plugins_view_goods_detail_photo_within_data) and is_array($plugins_view_goods_detail_photo_within_data)}}
                    {{foreach $plugins_view_goods_detail_photo_within_data as $hook}}
                        {{if is_string($hook) or is_int($hook)}}
                            {{$hook|raw}}
                        {{/if}}
                    {{/foreach}}
                {{/if}}
            </div>

            <!-- 商品页面相册底部钩子 -->
            {{if isset($shopxo_is_develop) and $shopxo_is_develop eq true and (!isset($is_footer) or $is_footer eq 1)}}
                <div class="plugins-tag">
                    <span>plugins_view_goods_detail_photo_bottom</span>
                </div>
            {{/if}}
            {{if !empty($plugins_view_goods_detail_photo_bottom_data) and is_array($plugins_view_goods_detail_photo_bottom_data)}}
                {{foreach $plugins_view_goods_detail_photo_bottom_data as $hook}}
                    {{if is_string($hook) or is_int($hook)}}
                        {{$hook|raw}}
                    {{/if}}
                {{/foreach}}
            {{/if}}
        </div>

        <!-- 右侧 -->
        <div class="clearfix-right">
            <!-- 商品页右侧内容顶部钩子 开始 -->
            {{if isset($shopxo_is_develop) and $shopxo_is_develop eq true and (!isset($is_footer) or $is_footer eq 1)}}
                <div class="plugins-tag">
                    <span>plugins_view_goods_detail_right_content_top</span>
                </div>
            {{/if}}
            {{if !empty($plugins_view_goods_detail_right_content_top_data) and is_array($plugins_view_goods_detail_right_content_top_data)}}
                {{foreach $plugins_view_goods_detail_right_content_top_data as $hook}}
                    {{if is_string($hook) or is_int($hook)}}
                        {{$hook|raw}}
                    {{/if}}
                {{/foreach}}
            {{/if}}
            <!-- 商品页右侧内容顶部钩子 结束 -->

            <!-- 右侧内容 -->
            <div class="clearfix-right-content">
                <!-- 商品页右侧内容内部顶部钩子 开始 -->
                {{if isset($shopxo_is_develop) and $shopxo_is_develop eq true and (!isset($is_footer) or $is_footer eq 1)}}
                    <div class="plugins-tag">
                        <span>plugins_view_goods_detail_right_content_inside_top</span>
                    </div>
                {{/if}}
                {{if !empty($plugins_view_goods_detail_right_content_inside_top_data) and is_array($plugins_view_goods_detail_right_content_inside_top_data)}}
                    {{foreach $plugins_view_goods_detail_right_content_inside_top_data as $hook}}
                        {{if is_string($hook) or is_int($hook)}}
                            {{$hook|raw}}
                        {{/if}}
                    {{/foreach}}
                {{/if}}
                <!-- 商品页右侧内容内部顶部钩子 结束 -->

                <!--规格/名称-->
                <div class="tb-detail-hd">
                    <h1 class="detail-title am-margin-bottom-xs" {{if !empty($goods.title_color)}}style="color:{{$goods.title_color}};"{{/if}}>
                        {{$goods.title}}
                        <!-- 公共icon数据 -->
                        {{if !empty($goods['plugins_view_icon_data']) and is_array($goods['plugins_view_icon_data'])}}
                            <span class="goods-plugins-view-icon-container">
                                {{foreach $goods.plugins_view_icon_data as $v}}
                                    {{if !empty($v) or is_array($v) and !empty($v['name'])}}
                                        <span class="am-badge am-radius" style="{{if !empty($v['br_color'])}}border:1px solid {{$v.br_color}};{{/if}}{{if !empty($v['color'])}}color:{{$v.color}};{{/if}}">{{$v.name}}</span>
                                    {{/if}}
                                {{/foreach}}
                            </span>
                        {{/if}}

                        <!-- 商品页面基础信息标题里面钩子 -->
                        {{if isset($shopxo_is_develop) and $shopxo_is_develop eq true and (!isset($is_footer) or $is_footer eq 1)}}
                            <div class="plugins-tag">
                                <span>plugins_view_goods_detail_title</span>
                            </div>
                        {{/if}}
                        {{if !empty($plugins_view_goods_detail_title_data) and is_array($plugins_view_goods_detail_title_data)}}
                            {{foreach $plugins_view_goods_detail_title_data as $hook}}
                                {{if is_string($hook) or is_int($hook)}}
                                    {{$hook|raw}}
                                {{/if}}
                            {{/foreach}}
                        {{/if}}
                    </h1>
                    {{if !empty($goods['simple_desc'])}}
                        <p class="simple-desc am-margin-bottom-xs">{{$goods.simple_desc}}</p>
                    {{/if}}
                </div>
                <div class="tb-detail-list">
                    <!-- 公共面板数据 -->
                    {{if !empty($goods['plugins_view_panel_data']) and is_array($goods['plugins_view_panel_data'])}}
                        <div class="goods-plugins-view-panel-container am-margin-bottom-sm">
                            {{foreach $goods.plugins_view_panel_data as $v}}
                                {{if is_string($v) or is_int($v)}}
                                    <p>{{$v}}</p>
                                {{/if}}
                            {{/foreach}}
                        </div>
                    {{/if}}

                    <!-- 商品页面基础信息顶部钩子 -->
                    {{if isset($shopxo_is_develop) and $shopxo_is_develop eq true and (!isset($is_footer) or $is_footer eq 1)}}
                        <div class="plugins-tag">
                            <span>plugins_view_goods_detail_base_top</span>
                        </div>
                    {{/if}}
                    {{if !empty($plugins_view_goods_detail_base_top_data) and is_array($plugins_view_goods_detail_base_top_data)}}
                        {{foreach $plugins_view_goods_detail_base_top_data as $hook}}
                            {{if is_string($hook) or is_int($hook)}}
                                {{$hook|raw}}
                            {{/if}}
                        {{/foreach}}
                    {{/if}}

                    <!-- 基础面板 -->
                    <div class="tb-detail-price">
                        <!-- 商品页面基础信息面板售价顶部钩子 -->
                        {{if isset($shopxo_is_develop) and $shopxo_is_develop eq true and (!isset($is_footer) or $is_footer eq 1)}}
                            <div class="plugins-tag">
                                <span>plugins_view_goods_detail_panel_price_top</span>
                            </div>
                        {{/if}}
                        {{if !empty($plugins_view_goods_detail_panel_price_top_data) and is_array($plugins_view_goods_detail_panel_price_top_data)}}
                            {{foreach $plugins_view_goods_detail_panel_price_top_data as $hook}}
                                {{if is_string($hook) or is_int($hook)}}
                                    {{$hook|raw}}
                                {{/if}}
                            {{/foreach}}
                        {{/if}}

                        <!-- 售价 -->
                        <div class="items price iteminfo_mktprice">
                            <dt>{{if empty($goods['show_field_price_text'])}}销售价{{else /}}{{$goods.show_field_price_text|raw}}{{/if}}</dt>
                            <dd>
                                {{if !empty($user)}}
                                <em>{{$currency_symbol}}</em>
                                <b class="goods-price" data-original-price="{{$goods.price}}">{{$goods.price}}</b>
                                {{else}}
                                <b class="goods-price-tip">会员可查看价格</b>
                                {{/if}}
                            </dd>                                 
                        </div>

                        <!-- 二维码 -->
                        <div class="goods-qrcode am-hide-sm-only">
                            <i class="am-icon-qrcode am-icon-sm"></i>
                            <img class="qrcode-images am-img-thumbnail" src="{{$qrcode_url}}" />
                        </div>

                        <!-- 商品页面基础信息面板底部钩子 -->
                        {{if isset($shopxo_is_develop) and $shopxo_is_develop eq true and (!isset($is_footer) or $is_footer eq 1)}}
                            <div class="plugins-tag">
                                <span>plugins_view_goods_detail_panel_bottom</span>
                            </div>
                        {{/if}}
                        {{if !empty($plugins_view_goods_detail_panel_bottom_data) and is_array($plugins_view_goods_detail_panel_bottom_data)}}
                            {{foreach $plugins_view_goods_detail_panel_bottom_data as $hook}}
                                {{if is_string($hook) or is_int($hook)}}
                                    {{$hook|raw}}
                                {{/if}}
                            {{/foreach}}
                        {{/if}}
                    </div>

                    <!--销量/浏览/评论-->
                    <ul class="tm-ind-panel">
                        <li class="tm-ind-item">
                            <div class="tm-indcon"><span class="tm-label">累计销量</span><span class="tm-count">{{$goods.sales_count}}</span></div>
                        </li>
                        <li class="tm-ind-item">
                            <div class="tm-indcon"><span class="tm-label">浏览次数</span><span class="tm-count">{{$goods.access_count}}</span></div>
                        </li>
                        <li class="tm-ind-item ind-panel-comment">
                            <div class="tm-indcon"><span class="tm-label">累计评论</span><span class="tm-count">{{$goods.comments_count}}</span></div>
                        </li>
                    </ul>

                    {{if !empty($goods['parameters']) and !empty($goods['parameters']['base'])}}
                        <!-- 商品基础参数 -->
                        <ul class="am-avg-sm-2 am-avg-md-2 am-avg-lg-3 am-padding-vertical-xs parameters-content parameters-base">
                            {{foreach $goods.parameters.base as $v}}
                                <li class="am-padding-vertical-xs am-padding-horizontal-sm am-text-truncate">
                                    <span>{{$v.name}}:</span>
                                    <span>{{$v.value}}</span>
                                </li>
                            {{/foreach}}
                        </ul>
                    {{/if}}

                    <!--各种规格-->
                    {{if $goods['is_shelves'] == 1 and $goods['inventorys'] gt 0}}
                        <dl class="iteminfo_parameter sys_item_specpara">
                            <dt class="buy-event mini-spec-event" data-type="buy">
                                <div class="cart-title">
                                    <span class="specpara-title">可选规格</span>
                                    <span class="am-icon-angle-right"></span>
                                </div>
                            </dt>
                            <dd>
                                <!--操作页面-->
                                <div class="theme-popover-mask"></div>
                                <div class="theme-popover">
                                    <div class="theme-span"></div>
                                    <div class="theme-poptit">
                                        <a href="javascript:;" title="关闭" class="close am-icon-close am-icon-sm"></a>
                                    </div>
                                    <div class="theme-popbod dform">
                                        <form class="theme-signin am-padding-sm" action="javascript:;">
                                            <div class="theme-signin-left">
                                                <!-- 商品页面规格顶部钩子 -->
                                                {{if isset($shopxo_is_develop) and $shopxo_is_develop eq true and (!isset($is_footer) or $is_footer eq 1)}}
                                                    <div class="plugins-tag">
                                                        <span>plugins_view_goods_detail_base_sku_top</span>
                                                    </div>
                                                {{/if}}
                                                {{if !empty($plugins_view_goods_detail_base_sku_top_data) and is_array($plugins_view_goods_detail_base_sku_top_data)}}
                                                    {{foreach $plugins_view_goods_detail_base_sku_top_data as $hook}}
                                                        {{if is_string($hook) or is_int($hook)}}
                                                            {{$hook|raw}}
                                                        {{/if}}
                                                    {{/foreach}}
                                                {{/if}}
                                                {{if !empty($goods['specifications']['choose'])}}
                                                    {{foreach $goods.specifications.choose as $key=>$spec}}
                                                        {{if !empty($spec['value'])}}
                                                            <div class="theme-options sku-items">
                                                                <div class="cart-title">{{$spec.name}}</div>
                                                                <ul>
                                                                    {{foreach $spec.value as $keys=>$specs}}
                                                                        <li class="sku-line {{if $keys == 0}}selected{{/if}}{{if !empty($specs['images'])}} sku-line-images{{/if}} {{if $key gt 0}} sku-dont-choose{{/if}} {{if isset($specs['is_only_level_one']) and isset($specs['inventory_public']) and $specs['inventory_public'] elt 0}} sku-items-disabled{{/if}}" data-type-value="{{$spec.name}}" data-value="{{$specs.name}}" {{if !empty($specs['images'])}} data-type-images="{{$specs.images}}"{{/if}}>
                                                                            {{if !empty($specs['images'])}}
                                                                                <img src="{{$specs.images}}" />
                                                                            {{/if}}
                                                                            {{$specs.name}}<i></i>
                                                                        </li>
                                                                    {{/foreach}}
                                                                </ul>
                                                            </div>
                                                        {{/if}}
                                                    {{/foreach}}
                                                {{/if}}

                                                <!-- 商品页面库存数量顶部钩子 -->
                                                {{if isset($shopxo_is_develop) and $shopxo_is_develop eq true and (!isset($is_footer) or $is_footer eq 1)}}
                                                    <div class="plugins-tag">
                                                        <span>plugins_view_goods_detail_base_inventory_top</span>
                                                    </div>
                                                {{/if}}
                                                {{if !empty($plugins_view_goods_detail_base_inventory_top_data) and is_array($plugins_view_goods_detail_base_inventory_top_data)}}
                                                    {{foreach $plugins_view_goods_detail_base_inventory_top_data as $hook}}
                                                        {{if is_string($hook) or is_int($hook)}}
                                                            {{$hook|raw}}
                                                        {{/if}}
                                                    {{/foreach}}
                                                {{/if}}

                                                <!-- 库存数量 -->
                                                <div class="theme-options">
                                                    <div class="cart-title number">数量</div>
                                                    <dd>
                                                        <div class="am-input-group am-input-group-sm number-tag">
                                                            <button class="am-input-group-label" id="min" type="button">-</button>
                                                            <input type="number" class="am-form-field" value="{{$goods.buy_min_number}}" id="text_box" min="{{$goods.buy_min_number}}" max="{{if empty($goods['buy_max_number'])}}{{$goods.inventory_public}}{{else /}}{{$goods.buy_max_number}}{{/if}}" data-original-max="{{$goods.inventory_public}}" />
                                                            <button class="am-input-group-label" id="add" type="button">+</button>
                                                        </div>
                                                        <span class="tb-hidden stock-tips"><span>库存</span><span class="stock" data-original-stock="{{$goods.inventory_public}}" data-min-limit="{{$goods.buy_min_number}}" data-max-limit="{{$goods.buy_max_number}}" data-unit="{{$goods.inventory_unit}}">{{$goods.inventory_public}}</span><span>{{$goods.inventory_unit}}</span></span>
                                                    </dd>
                                                </div>

                                                <!-- 商品页面库存数量底部钩子 -->
                                                {{if isset($shopxo_is_develop) and $shopxo_is_develop eq true and (!isset($is_footer) or $is_footer eq 1)}}
                                                    <div class="plugins-tag">
                                                        <span>plugins_view_goods_detail_base_inventory_bottom</span>
                                                    </div>
                                                {{/if}}
                                                {{if !empty($plugins_view_goods_detail_base_inventory_bottom_data) and is_array($plugins_view_goods_detail_base_inventory_bottom_data)}}
                                                    {{foreach $plugins_view_goods_detail_base_inventory_bottom_data as $hook}}
                                                        {{if is_string($hook) or is_int($hook)}}
                                                            {{$hook|raw}}
                                                        {{/if}}
                                                    {{/foreach}}
                                                {{/if}}

                                                <div class="btn-op">
                                                    <span class="btn am-btn am-btn-default confirm login-event" data-type="cart">确认</span>
                                                    <span class="btn close am-btn am-btn-danger cancel">取消</span>
                                                </div>
                                            </div>
                                            <div class="theme-signin-right">
                                                <div class="img-info">
                                                    <img src="{{$goods.images}}" />
                                                </div>
                                                <div class="text-info">
                                                    <span class="price-now" data-original-price="{{$goods.price}}">{{$currency_symbol}}{{$goods.price}}</span>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </dd>
                        </dl>
                    {{/if}}
                </div>

                <!-- 商品页面购买导航顶部钩子 -->
                {{if isset($shopxo_is_develop) and $shopxo_is_develop eq true and (!isset($is_footer) or $is_footer eq 1)}}
                    <div class="plugins-tag">
                        <span>plugins_view_goods_detail_buy_nav_top</span>
                    </div>
                {{/if}}
                {{if !empty($plugins_view_goods_detail_buy_nav_top_data) and is_array($plugins_view_goods_detail_buy_nav_top_data)}}
                    {{foreach $plugins_view_goods_detail_buy_nav_top_data as $hook}}
                        {{if is_string($hook) or is_int($hook)}}
                            {{$hook|raw}}
                        {{/if}}
                    {{/foreach}}
                {{/if}}

                <!-- 购买导航 -->
                <div class="buy-nav">
                    <div class="buy-nav-opt {{if !empty($buy_button) and isset($buy_button['count'])}}buy-nav-opt-button-number-{{$buy_button.count}}{{/if}}">
                        <!-- 商品页面基础信息购买小导航内部前面钩子 开始 -->
                        {{if isset($shopxo_is_develop) and $shopxo_is_develop eq true and (!isset($is_footer) or $is_footer eq 1)}}
                            <div class="plugins-tag">
                                <span>plugins_view_goods_detail_base_buy_nav_min_inside_begin</span>
                            </div>
                        {{/if}}
                        {{if !empty($plugins_view_goods_detail_base_buy_nav_min_inside_begin_data) and is_array($plugins_view_goods_detail_base_buy_nav_min_inside_begin_data)}}
                            {{foreach $plugins_view_goods_detail_base_buy_nav_min_inside_begin_data as $hook}}
                                {{if is_string($hook) or is_int($hook)}}
                                    {{$hook|raw}}
                                {{/if}}
                            {{/foreach}}
                        {{/if}}
                        <!-- 商品页面基础信息购买小导航内部前面钩子 结束 -->

                        <!-- 首页 -->
                        <a href="{{$Think.__MY_URL__}}" class=nav-min-home-submit>
                            <span class="nav-icon nav-icon-home">
                                <i class="am-icon-home am-icon-fw"></i>
                                <em>首页</em>
                            </span>
                        </a>

                        <!-- 收藏 -->
                        {{if isset($goods['is_favor']) and $goods['is_favor'] eq 1}}
                            <span class="nav-icon login-event favor-submit text-active" data-ajax-url="{{:MyUrl('index/goods/favor')}}">
                                <i class="am-icon-heart am-icon-fw"></i>
                                <em class="goods-favor-text">已收藏</em>
                                <em class="goods-favor-count">({{$goods.favor_count}})</em>
                            </span>
                        {{else /}}
                            <span class="nav-icon favor-submit login-event" data-ajax-url="{{:MyUrl('index/goods/favor')}}">
                                <i class="am-icon-heart am-icon-fw"></i>
                                <em class="goods-favor-text">收藏</em>
                                <em class="goods-favor-count">({{$goods.favor_count}})</em>
                            </span>
                        {{/if}}

                        <!-- 商品页面基础信息购买小导航内部后面钩子 开始 -->
                        {{if isset($shopxo_is_develop) and $shopxo_is_develop eq true and (!isset($is_footer) or $is_footer eq 1)}}
                            <div class="plugins-tag">
                                <span>plugins_view_goods_detail_base_buy_nav_min_inside</span>
                            </div>
                        {{/if}}
                        {{if !empty($plugins_view_goods_detail_base_buy_nav_min_inside_data) and is_array($plugins_view_goods_detail_base_buy_nav_min_inside_data)}}
                            {{foreach $plugins_view_goods_detail_base_buy_nav_min_inside_data as $hook}}
                                {{if is_string($hook) or is_int($hook)}}
                                    {{$hook|raw}}
                                {{/if}}
                            {{/foreach}}
                        {{/if}}
                        <!-- 商品页面基础信息购买小导航内部后面钩子 结束 -->
                    </div>

                    <!-- 购买容器 -->
                    {{if !empty($buy_button) and !empty($buy_button['count']) and !empty($buy_button['data']) and is_array($buy_button['data'])}}
                        <!-- 购买按钮列表 -->
                        <div class="buy-submit-container buy-submit-container-number-{{$buy_button.count}}">
                            {{foreach $buy_button.data as $v}}
                                {{if !empty($v['type']) and !empty($v['name'])}}
                                    {{switch $v.type}}
                                        {{case show}}
                                            <a href="{{if empty($v['value'])}}javascript:;{{else /}}tel:{{$v.value}}{{/if}}" 
                                            class="buy-btn {{if !empty($v['class'])}}{{$v.class}}{{/if}}" 
                                            {{if !empty($v['title'])}}title="{{$v.title}}"{{/if}} 
                                            data-type="{{$v.type}}" 
                                            data-value="{{if isset($v['value'])}}{{$v.value}}{{/if}}">
                                                {{if !empty($v['icon'])}}
                                                    <i class="{{$v.icon}}"></i>
                                                {{/if}}
                                                {{$v.name}}
                                            </a>
                                        {{/case}}
                                        {{default /}}
                                            <button type="button" 
                                            class="buy-btn {{$v.type}}-submit {{if !empty($v['color']) and $v['color'] eq 'second'}}buy-btn-second {{/if}} {{if !empty($v['class'])}}{{$v.class}} {{/if}}" 
                                            {{if !empty($v['title'])}}title="{{$v.title}}"{{/if}} 
                                            data-type="{{$v.type}}" 
                                            data-value="{{if isset($v['value'])}}{{$v.value}}{{/if}}">
                                                {{if !empty($v['icon'])}}
                                                    <i class="{{$v.icon}}"></i>
                                                {{/if}}
                                                {{$v.name}}
                                            </button>
                                    {{/switch}}
                                {{/if}}
                            {{/foreach}}
                        </div>

                        <!-- 购买表单 -->
                        <form action="{{:MyUrl('index/buy/index')}}" method="post" class="buy-form">
                            <input type="hidden" name="goods_id" value="{{$goods.id}}" />
                            <input type="hidden" name="buy_type" value="goods" />
                            <input type="hidden" name="stock" value="1" />
                            <input type="hidden" name="spec" value="" />
                            <input type="hidden" name="integral" id="integral" value="{{$integral}}" />
                            <button type="submit"></button>
                        </form>

                        <!-- 加入购物车表单 -->
                        <form action="{{:MyUrl('index/cart/save')}}" method="post" class="cart-form" request-type="ajax-fun" request-value="CartSubmitBack">
                            <input type="hidden" name="goods_id" value="{{$goods.id}}" />
                            <input type="hidden" name="stock" value="1" />
                            <input type="hidden" name="spec" value="" />
                            <button type="submit" class="am-hide"></button>
                        </form>
                    {{else /}}
                        <p class="goods-not-buy-tips">{{if empty($buy_button['error'])}}暂停销售{{else /}}{{$buy_button.error}}{{/if}}</p>
                    {{/if}}
                </div>

                <!-- 商品页右侧内容内部顶部钩子 开始 -->
                {{if isset($shopxo_is_develop) and $shopxo_is_develop eq true and (!isset($is_footer) or $is_footer eq 1)}}
                    <div class="plugins-tag">
                        <span>plugins_view_goods_detail_right_content_inside_bottom</span>
                    </div>
                {{/if}}
                {{if !empty($plugins_view_goods_detail_right_content_inside_bottom_data) and is_array($plugins_view_goods_detail_right_content_inside_bottom_data)}}
                    {{foreach $plugins_view_goods_detail_right_content_inside_bottom_data as $hook}}
                        {{if is_string($hook) or is_int($hook)}}
                            {{$hook|raw}}
                        {{/if}}
                    {{/foreach}}
                {{/if}}
                <!-- 商品页右侧内容内部顶部钩子 结束 -->
            </div>

            <!-- 商品页右侧内容底部钩子 开始 -->
            {{if isset($shopxo_is_develop) and $shopxo_is_develop eq true and (!isset($is_footer) or $is_footer eq 1)}}
                <div class="plugins-tag">
                    <span>plugins_view_goods_detail_right_content_bottom</span>
                </div>
            {{/if}}
            {{if !empty($plugins_view_goods_detail_right_content_bottom_data) and is_array($plugins_view_goods_detail_right_content_bottom_data)}}
                {{foreach $plugins_view_goods_detail_right_content_bottom_data as $hook}}
                    {{if is_string($hook) or is_int($hook)}}
                        {{$hook|raw}}
                    {{/if}}
                {{/foreach}}
            {{/if}}
            <!-- 商品页右侧内容底部钩子 结束 -->
        </div>
    </div>

    <!-- 商品页基础信息底部钩子 开始 -->
    {{if isset($shopxo_is_develop) and $shopxo_is_develop eq true and (!isset($is_footer) or $is_footer eq 1)}}
        <div class="plugins-tag">
            <span>plugins_view_goods_detail_base_bottom</span>
        </div>
    {{/if}}
    {{if !empty($plugins_view_goods_detail_base_bottom_data) and is_array($plugins_view_goods_detail_base_bottom_data)}}
        {{foreach $plugins_view_goods_detail_base_bottom_data as $hook}}
            {{if is_string($hook) or is_int($hook)}}
                {{$hook|raw}}
            {{/if}}
        {{/foreach}}
    {{/if}}
    <!-- 商品页基础信息底部钩子 结束 -->

    <!-- 左侧-->
    <div class="introduce am-container">
        <div class="browse">
            <!-- 商品页面左侧顶部钩子 -->
            {{if isset($shopxo_is_develop) and $shopxo_is_develop eq true and (!isset($is_footer) or $is_footer eq 1)}}
                <div class="plugins-tag">
                    <span>plugins_view_goods_detail_left_top</span>
                </div>
            {{/if}}
            {{if !empty($plugins_view_goods_detail_left_top_data) and is_array($plugins_view_goods_detail_left_top_data)}}
                {{foreach $plugins_view_goods_detail_left_top_data as $hook}}
                    {{if is_string($hook) or is_int($hook)}}
                        {{$hook|raw}}
                    {{/if}}
                {{/foreach}}
            {{/if}}

            <!-- 详情/推荐商品-->
            <div class="mc"> 
                 <ul>                       
                    <div class="mt">            
                        <h2>看了又看</h2>        
                    </div>
                    {{if !empty($left_goods)}}
                        {{foreach $left_goods as $key=>$v}}
                            <li {{if $key eq 0}}class="first"{{/if}}>
                                <div class="p-img">                    
                                    <a href="{{:$v['goods_url']}}">
                                        <img alt="{{$v.title}}" src="{{$v.images}}">
                                    </a>               
                                </div>
                                <div class="p-name am-text-truncate-2 am-margin-vertical-xs ">
                                    <a href="{{:$v['goods_url']}}" {{if !empty($v.title_color)}}style="color:{{$v.title_color}};"{{/if}}>{{$v.title}}</a>
                                </div>
                                {{if !empty($user)}}
                                    <div class="p-price"><strong>{{$currency_symbol}}{{$v.price}}</strong></div>
                                {{else}}
                                    <div class="p-price"><strong>会员可查看价格</strong></div>
                                {{/if}}
                            </li>
                          {{/foreach}}
                      {{/if}}
                 </ul>
            </div>
        </div>

        <!-- 右侧内容 -->
        <div class="introduce-main">
            <!-- 商品页面tabs顶部钩子 -->
            {{if isset($shopxo_is_develop) and $shopxo_is_develop eq true and (!isset($is_footer) or $is_footer eq 1)}}
                <div class="plugins-tag">
                    <span>plugins_view_goods_detail_tabs_top</span>
                </div>
            {{/if}}
            {{if !empty($plugins_view_goods_detail_tabs_top_data) and is_array($plugins_view_goods_detail_tabs_top_data)}}
                {{foreach $plugins_view_goods_detail_tabs_top_data as $hook}}
                    {{if is_string($hook) or is_int($hook)}}
                        {{$hook|raw}}
                    {{/if}}
                {{/foreach}}
            {{/if}}

            <!-- tab -->
            <div class="am-tabs" data-am-tabs="{noSwipe: 1}">
                <ul class="am-avg-sm-3 am-tabs-nav am-nav am-nav-tabs" data-am-sticky="{animation: 'slide-top'}">
                    <li class="am-active">
                        <a href="javascript:;">
                            <span class="index-needs-dt-txt">详情</span>
                        </a>
                    </li>
                    <li class="tabs-comment">
                        <a href="javascript:;">
                            <span class="index-needs-dt-txt">评论({{$goods.comments_count}})</span>
                        </a>
                    </li>
                    <li>
                        <a href="javascript:;">
                            <span class="index-needs-dt-txt">猜你喜欢</span>
                        </a>
                    </li>
                </ul>

                <!-- 详情 -->
                <div class="am-tabs-bd">
                    <div class="am-tab-panel am-fade am-in am-active">
                        {{if !empty($goods['parameters']) and !empty($goods['parameters']['detail'])}}
                            <!-- 商品详情参数 -->
                            <div class="am-cf tabs-nav-base-container">
                                <ul class="am-avg-sm-2 am-avg-md-3 am-avg-lg-4 am-padding-vertical-xs parameters-content parameters-detail">
                                    {{foreach $goods.parameters.detail as $v}}
                                        <li class="am-padding-vertical-xs am-padding-horizontal-sm am-text-truncate">
                                            <span>{{$v.name}}:</span>
                                            <span>{{$v.value}}</span>
                                        </li>
                                    {{/foreach}}
                                </ul>
                            </div>
                        {{/if}}

                        <!-- 详情内容 -->
                        <div class="detail-content am-margin-top-sm">
                            {{if isset($common_is_goods_detail_show_photo) and $common_is_goods_detail_show_photo eq 1 and !empty($goods.photo)}}
                                <!-- 详情相册 -->
                                <div class="content-photo">
                                    {{foreach $goods.photo as $photo}}
                                        <li>
                                            <img src="{{$photo.images}}" title="{{$goods.title}}" />
                                        </li>
                                    {{/foreach}}
                                </div>
                            {{/if}}
                            <!-- web详情 -->
                            <div class="content-web am-scrollable-horizontal">{{$goods.content_web|raw}}</div>
                        </div>
                    </div>

                    <!-- 评论 -->
                    <div class="am-tab-panel am-fade goods-comment" data-goods-id="{{$goods.id}}" data-url="{{:MyUrl('index/goods/comments')}}">
                        <div class="am-cf tabs-nav-base-container score-container">
                            <div class="score am-fl">
                                <p class="name">动态评分</p>
                                <p class="value">{{$goods_score.avg}}</p>
                            </div>
                            <div class="am-progress am-fr">
                                {{if isset($goods_score['avg']) and $goods_score['avg'] gt 0 and !empty($goods_score['rating'])}}
                                    {{foreach $goods_score.rating as $score}}
                                        {{if $score.portion gt 0}}
                                            <div class="am-progress-bar 
                                                {{switch score.rating}}
                                                    {{case 1}}
                                                        am-progress-bar-danger
                                                    {{/case}}
                                                    {{case 2}}
                                                        am-progress-bar-warning
                                                    {{/case}}
                                                    {{case 3}}
                                                        am-progress-bar-secondary
                                                    {{/case}}
                                                    {{case 5}}
                                                        am-progress-bar-success
                                                    {{/case}}
                                                {{/switch}}"
                                                style="width: {{$score.portion}}%">{{$score.name}}({{$score.portion}}%)</div>
                                            {{/if}}
                                    {{/foreach}}
                                {{else /}}
                                    没有评分数据
                                {{/if}}
                            </div>
                        </div>
                        <div class="goods-comment-content"></div>
                        <div class="goods-page-container"></div>
                        <div class="table-no goods-page-no-data none">
                            <i class="am-icon-warning"></i>
                            <span>没有评论数据</span>
                        </div>
                    </div>

                    <!-- 猜你喜欢 -->
                    <div class="am-tab-panel am-fade">
                        <div class="like">
                            <ul class="am-avg-sm-2 am-avg-md-3 am-avg-lg-4 boxes">
                                {{if !empty($detail_like_goods)}}
                                    {{foreach $detail_like_goods as $key=>$v}}
                                        <li>
                                            <div class="i-pic limit">
                                                <a href="{{:$v['goods_url']}}">
                                                    <img alt="{{$v.title}}" src="{{$v.images}}" />
                                                </a>
                                                <a href="{{:$v['goods_url']}}">
                                                    <p class="am-text-truncate-2 am-margin-bottom-xs" {{if !empty($v.title_color)}}style="color:{{$v.title_color}};"{{/if}}>{{$v.title}}</p>
                                                </a>
                                                <p class="price fl">
                                                    <strong>{{$currency_symbol}}{{$v.price}}</strong>
                                                </p>
                                            </div>
                                        </li>
                                    {{/foreach}}
                                {{/if}}
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 商品页面tabs底部钩子 -->
            {{if isset($shopxo_is_develop) and $shopxo_is_develop eq true and (!isset($is_footer) or $is_footer eq 1)}}
                <div class="plugins-tag">
                    <span>plugins_view_goods_detail_tabs_bottom</span>
                </div>
            {{/if}}
            {{if !empty($plugins_view_goods_detail_tabs_bottom_data) and is_array($plugins_view_goods_detail_tabs_bottom_data)}}
                {{foreach $plugins_view_goods_detail_tabs_bottom_data as $hook}}
                    {{if is_string($hook) or is_int($hook)}}
                        {{$hook|raw}}
                    {{/if}}
                {{/foreach}}
            {{/if}}
        </div>
    </div>
</div>

{{include file="public/footer" /}}

<script type="text/javascript">
// 购物车回调
function CartSubmitBack(e)
{
    if(e.code == 0)
    {
        HomeCartNumberTotalUpdate(parseInt(e.data));
        Prompt(e.msg, 'success');
    } else {
        Prompt(e.msg);
    }
    $.AMUI.progress.done();
    $('form.cart-form').find('button[type="submit"]').button('reset');
}
</script>
